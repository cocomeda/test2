<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LIFFからGASへ送信</title>
  <style>
    input[type="text"] { width: 80%; padding: 10px; }
    input[type="submit"] { padding: 10px 20px; }
    #response { margin-top: 20px; }
  </style>
</head>
<body>
  <h2>文字を送信</h2>
  <form id="myForm">
    <input type="text" id="inputText" name="inputText" required>
    <input type="submit" value="送信">
  </form>
  <div id="response"></div>


  
<script>
let userId = "";
let displayName = "";

// LIFF 初期化とプロフィール取得
liff.init({ liffId: "1657196041-ALeOLrEa" }).then(() => {
  return liff.getProfile();
}).then(profile => {
  displayName = profile.displayName;
  userId = profile.userId;
}).catch(err => {
  document.getElementById('response').innerText = "LIFFログインに失敗しました";
});

// フォーム送信処理
document.getElementById('myForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const inputText = document.getElementById('inputText').value;
  const gasUrl = "https://script.google.com/macros/s/AKfycbzKwkP50EiUW8ZmeC9Hmfi0oH-vgOFyvXbQGSx_PPJObjYSZmgpSgN7LUqRD_LlP-KNhw/exec";

  const formData = new URLSearchParams();
  formData.append('inputText', inputText);
  formData.append('userId', userId);
  formData.append('displayName', displayName);

  fetch(gasUrl, {
    method: 'POST',
    body: formData,
  })
  .then(response => response.json())
  .then(data => {
    document.getElementById('response').innerText = data.message;
    document.getElementById('myForm').reset();
  })
  .catch(error => {
    document.getElementById('response').innerText = 'エラーが発生しました: ' + error.message;
  });
});
</script>
</body>
</html>


